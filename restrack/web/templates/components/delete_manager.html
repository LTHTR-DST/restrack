{% if worklists %}
<div class="mb-3">
    <label class="form-label">Select worklist to delete</label>
    <select class="form-select" id="delete-worklist-select">
        <option value="">Choose a worklist...</option>
        {% for worklist in worklists %}
        <option value="{{ worklist.id }}">{{ worklist.name }} (ID: {{ worklist.id }})</option>
        {% endfor %}
    </select>
</div>
<button class="btn btn-danger" onclick="deleteSelectedWorklist()">
    <i class="bi bi-trash"></i>
    Delete Worklist
</button>

<script>
    function deleteSelectedWorklist() {
        const select = document.getElementById('delete-worklist-select');
        const worklistId = select.value;
        const worklistName = select.options[select.selectedIndex].text;

        if (!worklistId) {
            showAlert('Please select a worklist to delete', 'warning');
            return;
        }

        if (!confirm(`Are you sure you want to COMPLETELY DELETE the worklist "${worklistName}"? This action cannot be undone!`)) {
            return;
        }

        fetch(`/api/v1/delete_worklist/${worklistId}`, {
            method: 'DELETE'
        })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    showAlert(data.message, 'success');
                    select.value = '';
                    // Refresh all worklist components
                    htmx.ajax('GET', '/worklists/selector', { target: '#worklist-selector' });
                    htmx.ajax('GET', '/worklists/subscription-manager', { target: '#subscription-manager' });
                    htmx.ajax('GET', '/worklists/copy-manager', { target: '#copy-manager' });
                    htmx.ajax('GET', '/worklists/delete-manager', { target: '#delete-worklist-manager' });
                } else {
                    showAlert('Failed to delete worklist', 'danger');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showAlert('Error deleting worklist', 'danger');
            });
    }
</script>
{% else %}
<div class="text-center text-muted">
    <p>No worklists available to delete.</p>
</div>
{% endif %}
